<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Analyzing and visualizing fiber photometry data with fluoR</title>
  <meta name="description" content="This is meant to explain the reasoning behind fluoR’s functions and how to use them." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Analyzing and visualizing fiber photometry data with fluoR" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is meant to explain the reasoning behind fluoR’s functions and how to use them." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Analyzing and visualizing fiber photometry data with fluoR" />
  
  <meta name="twitter:description" content="This is meant to explain the reasoning behind fluoR’s functions and how to use them." />
  

<meta name="author" content="Andrew Tamalunas" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  

<link rel="next" href="intro.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Analyzing and visualizing fiber photometry data with fluoR</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#index-whyfluor"><i class="fa fa-check"></i><b>1.1</b> Why use fluoR?</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#index-whofluorfor"><i class="fa fa-check"></i><b>1.2</b> Who is fluoR for?</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#background"><i class="fa fa-check"></i><b>1.3</b> Background</a><ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#index-prerecording"><i class="fa fa-check"></i><b>1.3.1</b> pre-recording</a></li>
<li class="chapter" data-level="1.3.2" data-path="index.html"><a href="index.html#index-recording"><i class="fa fa-check"></i><b>1.3.2</b> recording</a></li>
<li class="chapter" data-level="1.3.3" data-path="index.html"><a href="index.html#index-postrecording"><i class="fa fa-check"></i><b>1.3.3</b> post-recording</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Setting up fluoR</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#intro-install"><i class="fa fa-check"></i><b>2.1</b> Installation</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#intro-convert"><i class="fa fa-check"></i><b>2.2</b> Convert to fluoR format</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#intro-inout"><i class="fa fa-check"></i><b>2.3</b> Input/Output</a></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#intro-examples"><i class="fa fa-check"></i><b>2.4</b> Examples</a><ul>
<li class="chapter" data-level="2.4.1" data-path="intro.html"><a href="intro.html#intro-formatdata"><i class="fa fa-check"></i><b>2.4.1</b> Format data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="stand.html"><a href="stand.html"><i class="fa fa-check"></i><b>3</b> Standardizing Data</a><ul>
<li class="chapter" data-level="3.1" data-path="stand.html"><a href="stand.html#stand-reasons"><i class="fa fa-check"></i><b>3.1</b> Reasons to standardize data</a></li>
<li class="chapter" data-level="3.2" data-path="stand.html"><a href="stand.html#stand-methods"><i class="fa fa-check"></i><b>3.2</b> Methods of standardization</a><ul>
<li class="chapter" data-level="3.2.1" data-path="stand.html"><a href="stand.html#stand-methods-zscore"><i class="fa fa-check"></i><b>3.2.1</b> z-scores</a></li>
<li class="chapter" data-level="3.2.2" data-path="stand.html"><a href="stand.html#stand-methods-bzscore"><i class="fa fa-check"></i><b>3.2.2</b> baseline z-scores</a></li>
<li class="chapter" data-level="3.2.3" data-path="stand.html"><a href="stand.html#stand-methods-mzscore"><i class="fa fa-check"></i><b>3.2.3</b> modified z scores</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="stand.html"><a href="stand.html#stand-comparison"><i class="fa fa-check"></i><b>3.3</b> z-score comparison</a><ul>
<li class="chapter" data-level="3.3.1" data-path="stand.html"><a href="stand.html#stand-comparison-vis"><i class="fa fa-check"></i><b>3.3.1</b> Visualization</a></li>
<li class="chapter" data-level="3.3.2" data-path="stand.html"><a href="stand.html#stand-comparison-table"><i class="fa fa-check"></i><b>3.3.2</b> Summary table</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="stand.html"><a href="stand.html#stand-examples"><i class="fa fa-check"></i><b>3.4</b> Examples</a><ul>
<li class="chapter" data-level="3.4.1" data-path="stand.html"><a href="stand.html#stand-examples-ex1"><i class="fa fa-check"></i><b>3.4.1</b> Example 1</a></li>
<li class="chapter" data-level="3.4.2" data-path="stand.html"><a href="stand.html#stand-examples-ex2"><i class="fa fa-check"></i><b>3.4.2</b> Example 2</a></li>
<li class="chapter" data-level="3.4.3" data-path="stand.html"><a href="stand.html#stand-examples-ex3"><i class="fa fa-check"></i><b>3.4.3</b> Example 3</a></li>
<li class="chapter" data-level="3.4.4" data-path="stand.html"><a href="stand.html#stand-examples-ex4"><i class="fa fa-check"></i><b>3.4.4</b> Example 4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="vis.html"><a href="vis.html"><i class="fa fa-check"></i><b>4</b> Visualization</a><ul>
<li class="chapter" data-level="4.1" data-path="vis.html"><a href="vis.html#vis-multiple"><i class="fa fa-check"></i><b>4.1</b> Multiple trials</a><ul>
<li class="chapter" data-level="4.1.1" data-path="vis.html"><a href="vis.html#vis-multiple-plotfluor"><i class="fa fa-check"></i><b>4.1.1</b> plot_trials</a></li>
<li class="chapter" data-level="4.1.2" data-path="vis.html"><a href="vis.html#vis-multiple-plotgg"><i class="fa fa-check"></i><b>4.1.2</b> ggplot2</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="vis.html"><a href="vis.html#vis-ranges"><i class="fa fa-check"></i><b>4.2</b> Trial ranges</a></li>
<li class="chapter" data-level="4.3" data-path="vis.html"><a href="vis.html#vis-smoothing"><i class="fa fa-check"></i><b>4.3</b> Smoothing</a><ul>
<li class="chapter" data-level="4.3.1" data-path="vis.html"><a href="vis.html#vis-smoothing-whittaker"><i class="fa fa-check"></i><b>4.3.1</b> Whittaker filter</a></li>
<li class="chapter" data-level="4.3.2" data-path="vis.html"><a href="vis.html#vis-smoothing-gam"><i class="fa fa-check"></i><b>4.3.2</b> Generalized additive modeling</a></li>
<li class="chapter" data-level="4.3.3" data-path="vis.html"><a href="vis.html#vis-smoothing-loess"><i class="fa fa-check"></i><b>4.3.3</b> Loess</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="vis.html"><a href="vis.html#vis-furtherreading"><i class="fa fa-check"></i><b>4.4</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="analysis.html"><a href="analysis.html"><i class="fa fa-check"></i><b>5</b> Analysis</a><ul>
<li class="chapter" data-level="5.1" data-path="analysis.html"><a href="analysis.html#analysis-metrics"><i class="fa fa-check"></i><b>5.1</b> Metrics</a><ul>
<li class="chapter" data-level="5.1.1" data-path="analysis.html"><a href="analysis.html#analysis-metrics-peaks"><i class="fa fa-check"></i><b>5.1.1</b> Peaks</a></li>
<li class="chapter" data-level="5.1.2" data-path="analysis.html"><a href="analysis.html#analysis-metrics-auc"><i class="fa fa-check"></i><b>5.1.2</b> Area under curve</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="analysis.html"><a href="analysis.html#analysis-app"><i class="fa fa-check"></i><b>5.2</b> Applications</a><ul>
<li class="chapter" data-level="5.2.1" data-path="analysis.html"><a href="analysis.html#analysis-app-numpeaks"><i class="fa fa-check"></i><b>5.2.1</b> Number of peaks above z score</a></li>
<li class="chapter" data-level="5.2.2" data-path="analysis.html"><a href="analysis.html#analysis-app-peakdist"><i class="fa fa-check"></i><b>5.2.2</b> Distance between peaks</a></li>
<li class="chapter" data-level="5.2.3" data-path="analysis.html"><a href="analysis.html#analysis-app-auc"><i class="fa fa-check"></i><b>5.2.3</b> Area under curve</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Analyzing and visualizing fiber photometry data with fluoR</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="header">
<h1 class="title">Analyzing and visualizing fiber photometry data with fluoR</h1>
<p class="author"><em>Andrew Tamalunas</em></p>
<p class="date"><em>Last updated 2020-12-08</em></p>
</div>
<div id="index" class="section level1">
<h1><span class="header-section-number">Chapter 1</span> Introduction</h1>
<p><i>Analyzing and visualizing fiber photometry data with fluoR</i> is a continuously updated book of tutorials and background information for analyzing and visualizing time series data from behavioral experiments.</p>
<div id="index-whyfluor" class="section level2">
<h2><span class="header-section-number">1.1</span> Why use fluoR?</h2>
<p>The <code>fluoR</code> R package is the successor to the <code>GCalcium</code> package, which I initially wrote to help ensure that my fiber photometry data analyses were accurate, consistent, and transparent. Both R packages and this continuously-updated document were publicly released to save other researchers the time and uncertainty in working with their own data, along with helping keep my knowledge fresh. I will mostly avoid discussion on biological topics for now.</p>
<p>Calcium imaging technologies such as GCaMP produce massive datasets. With repeated trials for each subject, researchers can end up with tens of thousands of data points per subject. Complicating matters further, there seems to be no gold standard for working with and analyzing this type of data.</p>
<p>fluoR…</p>
<ul>
<li>is open-source and transparent</li>
<li>has its own user manual</li>
<li>is free to use</li>
</ul>
</div>
<div id="index-whofluorfor" class="section level2">
<h2><span class="header-section-number">1.2</span> Who is fluoR for?</h2>
<p>Some examples of researchers who may find fluoR useful are those who:</p>
<ul>
<li>have recorded multiple trials of time series waveform data</li>
<li>want to look at their recorded data with minimal coding while still knowing how their code works</li>
<li>want to test GCaMP data before using the hardware (see <code>GCaMP</code> sample dataset)</li>
</ul>
</div>
<div id="background" class="section level2">
<h2><span class="header-section-number">1.3</span> Background</h2>
<div id="index-prerecording" class="section level3">
<h3><span class="header-section-number">1.3.1</span> pre-recording</h3>
<p>I initially wrote the fluoR package (then named GCalcium) for a pilot study by <a href="https://www.colorado.edu/psych-neuro/michael-baratta">Dr. Michael Baratta</a>. After the main investigators set up the GCaMP6m fiber photometry technology, neural activity was continuously recorded in the infralimbic region (IL) of the ventromedial prefrontal cortex (mPFCv) during escapable tail shock - a “controllable” stressor. We wanted to examine if post-trial neural activity in the rat IL changes after repeated exposure to a controllable stressor.</p>
<p>There were two main issues that resulted in us using GCaMP for measuring neural activity:</p>
<ol style="list-style-type: decimal">
<li>electrophysiology is difficult to conduct when using tail shock as a stressor</li>
<li><i>fos</i> examination is limited temporally</li>
</ol>
<p>The included <code>GCaMP</code> dataset is a sample of 10 random trials from this pilot study.</p>
</div>
<div id="index-recording" class="section level3">
<h3><span class="header-section-number">1.3.2</span> recording</h3>
<p>For recording, we used fiber photometry equipment from <a href="https://www.tdt.com/">Tucker-Davis Technologies</a>, which was set up by <a href="https://www.colorado.edu/neuroscience/david-root">Dr. David Root</a>.</p>
</div>
<div id="index-postrecording" class="section level3">
<h3><span class="header-section-number">1.3.3</span> post-recording</h3>
<p>Dr. Root also provided us with a modified version of a Matlab script to load and pre-process the data <span class="citation">(Root <a href="#ref-root_fiber_2018" role="doc-biblioref">2018</a>)</span>. Ultimately, I decided to export the data for use in another program after the signal averaging step.</p>
<p>There were a couple of Python add-ons that looked promising. Unfortunately, none of them seemed to discuss how they worked or why the authors took the steps that they did. Using these would make me at odds with my philosophy of “don’t run analyses if you don’t know how they work”. I decided that R, which I had a much more solid background in, was the answer.</p>
<p>While R is generally slower than Matlab, the syntax is much simpler and it is easier to keep track of the steps you took along the way. Additionally, there are a handful of R packages (e.g. ggplot2, plotly) that allow for publication-ready graphs.</p>
<p>Did I mention R is free?</p>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-root_fiber_2018">
<p>Root, David H. 2018. “Fiber Photometry Epoch Averaging Example.” <em>Fiber Photometry Epoch Averaging Example</em>. <a href="https://www.tdt.com/support/matlab-sdk/offline-analysis-examples/fiber-photometry-epoch-averaging-example/">https://www.tdt.com/support/matlab-sdk/offline-analysis-examples/fiber-photometry-epoch-averaging-example/</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>

<a href="intro.html" class="navigation navigation-next navigation-unique" aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["fluoR_bookdown.pdf", "fluoR_bookdown.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
